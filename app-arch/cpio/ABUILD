pkgname=cpio
pkgver=2.13
pkgbuild=2
arch=('auto')

shortdesc=("A tool to copy files into or out of a cpio or tar archive")
longdesc=("GNU cpio copies files into or out of a cpio or tar archive. The archive can be another file on the disk, a magnetic tape, or a pipe.")

source=("https://ftp.gnu.org/gnu/cpio/cpio-${pkgver}.tar.gz")

tags="base app-arch"

build_deps="glibc"

build() {
  go_src_dir

# https://wiki.gentoo.org/wiki/Gcc_10_porting_notes/fno_common
  CFLAGS+=' -fcommon'

  ./configure --prefix=/usr --mandir=/usr/share/man
  make -j${numjobs}

  make DESTDIR="${pkgdir}" install
  rm -f "${pkgdir}/usr/bin/mt" "${pkgdir}/pkg/usr/share/man/man1/mt.1"
  rm -rf "${pkgdir}/usr/libexec"
  rm -f "${pkgdir}/usr/share/man/man8/rmt.8"
  # remove infodir
  rm "$pkgdir/usr/share/info/dir"
}
