pkgname=zfp
pkgver=0.5.5
pkgbuild=1
arch=('auto')

shortdesc=("Compressed numerical arrays that support high-speed random access")
longdesc=("zfp is a BSD licensed open-source library for compressed floating-point arrays that support high throughput read and write random access.")

tags=('base app-arch')

source=("https://github.com/LLNL/zfp/archive/${pkgver}/${pkgname}-${pkgver}.tar.gz")

build_deps="glibc gcc-libs cmake gcc-fortran python-cython python python-numpy"

build() {
  go_src_dir
  burn_patches
  cmake -B build \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_SKIP_RPATH=ON \
    -DBUILD_CFP=ON \
    -DBUILD_ZFPY=ON \
    -DBUILD_ZFORP=ON
  make -C build
  make -C build DESTDIR="${pkgdir}" install
  install -D build/bin/zfp -t "${pkgdir}"/usr/bin
  install -Dm644 LICENSE -t "${pkgdir}"/usr/share/licenses/${pkgname}
}
