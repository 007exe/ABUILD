#!/bin/bash

# NOTE: Этот скрипт предназначен для организации очереди сборки пакетов
# WARNING: Скрипт не умеер разделять мультипакеты на категории

# FIXME: Проблемы со сборкой документации

LIST="multilib-lib32/lib32-glib2
x11-libs/intel-media-driver
multilib-lib32/lib32-faudio
x11-libs/libva
media-gfx/graphicsmagick
media-video/rav1e
kde-misc/kjots
dev-python/python-jarowinkler
dev-python/python-rapidfuzz
dev-python/python-sphinxcontrib-towncrier
dev-python/python-pip
dev-python/python-solidpython
multilib-lib32/lib32-libsamplerate
multilib-lib32/lib32-jack
multilib-lib32/lib32-portaudio
multilib-lib32/lib32-pipewire
multilib-lib32/lib32-at-spi2-atk
multilib-lib32/lib32-linux-pam
multilib-lib32/lib32-polkit
multilib-lib32/lib32-colord
       lib32-gtk2
multilib-lib32/lib32-gtk3
       lib32-libltdl
       lib32-libpulse
       lib32-tdb
multilib-lib32/lib32-libcanberra
       lib32-libepoxy
       lib32-librsvg
       lib32-libxcursor
       lib32-libxdamage
       lib32-libxkbcommon
       lib32-libxrandr
multilib-lib32/lib32-mesa
       lib32-pango
       lib32-wayland
       lib32-libasyncns
       lib32-libcap
multilib-lib32/lib32-libpulse
       lib32-ladspa
       lib32-libinstpatch
       lib32-libxss
multilib-lib32/lib32-libdrm
       lib32-libxshmfence
       lib32-libvdpau
       lib32-libva
       lib32-libelf
       lib32-llvm
       lib32-clang
       lib32-libglvnd
       lib32-libunwind
       lib32-lm_sensors
       lib32-llvm-libs
       lib32-libxrender
multilib-lib32/lib32-sdl2
multilib-lib32/lib32-fluidsynth
multilib-lib32/lib32-openal
multilib-lib32/lib32-mpg123
       lib32-cdparanoia
       lib32-libtheora
       lib32-libvisual
       lib32-libxv
       lib32-orc
       lib32-aalib
       lib32-cairo
       lib32-libavc1394
       lib32-libcaca
       lib32-libdv
       lib32-libiec61883
       lib32-libraw1394
       lib32-libshout
       lib32-libsoup3
       lib32-libvpx
       lib32-speex
       lib32-taglib
       lib32-twolame
       lib32-wavpack
multilib-lib32/lib32-gstreamer
app-emulation/wine
multilib-lib32/lib32-faudio
app-text/qpdf
net-news/liferea
net-p2p/deluge
(ДОРАБОТАТЬ_ПАКЕТ_foo2zjs)
net-print/foo2zjs
net-print/foomatic-db-engine
net-voip/mumble
net-wireless/hostapd
sys-fs/f2fs-tools
sys-fs/ncdu
sys-kernel/bbswitch
dev-db/freetds
dev-db/postgis
dev-db/mysql-workbench
       sqlcipher 
       qcustomplot
       qhexedit2
x11-libs/qscintilla
dev-db/sqlitebrowser
sys-libs/efivar
sys-apps/fbset
dev-libs/libx86emu
sys-apps/hwinfo
sys-apps/mlocate
sys-apps/tcp_wrappers
app-arch/mgard
app-arch/unace
app-crypt/gpgme
app-i18n/poedit
app-text/a2ps
app-text/dblatex
app-text/fbreader
app-text/libgepub
dev-java/bcprov
       strip-nondeterminism
app-text/pdftk
app-text/podofo
app-text/xpdf
app-text/texlive-bin
dev-libs/tl-expected
dev-lang/julia
dev-lang/tcc
dev-lang/mono
dev-libs/cloog
dev-libs/cudnn
app-text/docbook-utils
dev-libs/gmime
dev-libs/libphonenumber
dev-libs/js78
dev-libs/js91
dev-util/codeblocks
net-analyzer/nmap
net-fs/cifs-utils
       gperftools
sys-cluster/glusterfs
       python3-dateutils
net-fs/samba
net-ftp/filezilla
net-ftp/tftp-hpa
net-im/ejabberd
net-libs/farstream
net-libs/libotr
net-libs/serf
net-libs/gupnp-igd
net-libs/wpewebkit
net-libs/webkit2gtk
net-libs/webkit2gtk-4.1
net-libs/webkit2gtk-5.0
gnome-extra/yad
ocaml-compiler-libs
       gtkspell3
       ocaml-cairo
dev-ml/lablgtk3
net-misc/unison
x11-misc/xsel
x11-misc/synergy
app-accessibility/flite
media-libs/qtav
media-libs/projectm
media-libs/libquvi
       python-bsddb
       gst-python
       python-mutagen
media-sound/exaile
       python-simplejson
       python-pylast
       python-mutagen
       python3-keybinder
media-sound/foobnix
media-sound/lollypop
media-libs/libjxl
dev-java/eclipse-ecj
dev-java/icedtea-web
gnome-libs/retro-gtk
gnome-libs/gnome-games
app-editors/neovim

x11-libs/goffice
media-gfx/graphicsmagick
app-text/psiconv
app-office/abiword
dev-libs/libdbi-drivers
app-office/gnucash
app-office/gnumeric
app-office/libreoffice
app-office/scribus
app-office/unoconv
xorg-apps/xorg-xdm
sci-libs/avogadrolibs

dev-lang/ghc
dev-haskell/haskell-hscolour
dev-haskell/alex
dev-haskell/happy
dev-haskell/uusi
dev-haskell/haskell-erf
dev-haskell/haskell-splitmix
dev-haskell/haskell-random
dev-haskell/haskell-quickcheck

       haskell-hspec
       haskell-silently
dev-haskell/haskell-nanospec
dev-haskell/haskell-call-stack
dev-haskell/haskell-hunit
       haskell-libxml
       haskell-ansi-terminal
       haskell-ansi-wl-pprint
       haskell-hostname
       haskell-old-locale
       haskell-regex-posix
       haskell-xml
dev-haskell/haskell-test-framework
Неудовлетворённые зависимости: haskell-test-framework-quickcheck2
dev-haskell/haskell-diff

dev-haskell/haskell-tasty
dev-haskell/haskell-tasty-golden
dev-haskell/haskell-tasty-hunit
dev-haskell/haskell-tasty-lua
dev-haskell/haskell-tasty-quickcheck
dev-haskell/haskell-glob
dev-haskell/haskell-juicypixels
dev-haskell/haskell-sha
dev-haskell/haskell-aeson
dev-haskell/haskell-aeson-pretty
dev-haskell/haskell-attoparsec
dev-haskell/haskell-base64
dev-haskell/haskell-blaze-html
dev-haskell/haskell-blaze-markup
dev-haskell/haskell-case-insensitive
dev-haskell/haskell-citeproc
dev-haskell/haskell-commonmark
dev-haskell/haskell-commonmark-extensions
dev-haskell/haskell-commonmark-pandoc
dev-haskell/haskell-connection
dev-haskell/haskell-data-default
dev-haskell/haskell-doclayout
dev-haskell/haskell-doctemplates
dev-haskell/haskell-emojis
dev-haskell/haskell-file-embed
dev-haskell/haskell-gridtables
dev-haskell/haskell-haddock-library
dev-haskell/haskell-hslua
dev-haskell/haskell-hslua-aeson
dev-haskell/haskell-hslua-module-doclayout
dev-haskell/haskell-hslua-module-path
dev-haskell/haskell-hslua-module-system
dev-haskell/haskell-hslua-module-text
dev-haskell/haskell-hslua-module-version
dev-haskell/haskell-http-client
dev-haskell/haskell-http-client-tls
dev-haskell/haskell-http-types
dev-haskell/haskell-ipynb
dev-haskell/haskell-jira-wiki-markup
dev-haskell/haskell-lpeg
dev-haskell/haskell-network
dev-haskell/haskell-network-uri
dev-haskell/haskell-pandoc-lua-marshal
dev-haskell/haskell-pandoc-types
dev-haskell/haskell-pretty-show
dev-haskell/haskell-safe
dev-haskell/haskell-scientific
dev-haskell/haskell-servant-server
dev-haskell/haskell-skylighting
dev-haskell/haskell-skylighting-core
dev-haskell/haskell-split
dev-haskell/haskell-syb
dev-haskell/haskell-tagsoup
dev-haskell/haskell-temporary
dev-haskell/haskell-texmath
dev-haskell/haskell-text-conversions
dev-haskell/haskell-unicode-collation
dev-haskell/haskell-unicode-transforms
dev-haskell/haskell-wai
dev-haskell/haskell-wai-extra
dev-haskell/haskell-warp
dev-haskell/haskell-xml
dev-haskell/haskell-xml-conduit
dev-haskell/haskell-xml-types
dev-haskell/haskell-yaml
dev-haskell/haskell-zip-archive
dev-haskell/haskell-zlib
app-text/pandoc
app-admin/conky
net-libs/gssdp
       haskell-x11
       haskell-x11-xft
       haskell-utf8-string
       haskell-network-uri
       haskell-hinotify
       haskell-parsec-numbers
       haskell-regex-compat
       haskell-old-locale
       haskell-http
       haskell-dbus
       haskell-libmpd
       haskell-cereal
       haskell-netlink
       haskell-async
       haskell-aeson
       haskell-timezone-olson
       haskell-timezone-series
       haskell-extensible-exceptions
       haskell-http-conduit
       haskell-http-types
       haskell-http-client-tls
       haskell-alsa-core
       haskell-alsa-mixer
x11-misc/xmobar
www-client/firefox"

STARTD=`pwd`
#LOGFILE=~/Yandex.Disk/build.log
LOGFILE=~/build.log

echo "============================= Начало сборки `date` =============================" >> $LOGFILE

# -pod ~/Yandex.Disk/Testing_x86_64/repository/pkg

for i in $LIST ; do
    cd $STARTD/$i
    if mkpkg -ba -wd ~/mkpkg/build -si ; then
           echo "$i ГОТОВ" >> $LOGFILE
           cd $STARTD
    else
           echo "$i НЕ СОБРАН!!!" >> $LOGFILE
           cd $STARTD
    fi
done

echo "============================= Завершено `date` =============================" >> $LOGFILE

mpkg-index Yandex.Disk/Testing_x86_64/repository/
mpkg-update
mpkg-upgradeall

rm -f dupes.log
rm -f index.log
rm -f package_list

sudo poweroff
