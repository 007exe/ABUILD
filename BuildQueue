#!/bin/bash

# NOTE: Этот скрипт предназначен для организации очереди сборки пакетов
# WARNING: Скрипт не умеер разделять мультипакеты на категории

LIST="dev-python/python-keyring
dev-python/python-virtualenv
dev-python/python-poetry-core
dev-python/python-black
dev-python/python-lazy-object-proxy
dev-python/python-pylint
dev-python/python-solidpython
app-admin/conky
gnome-libs/gcab
app-arch/unace
app-cdr/cdemu-daemon
app-editors/jedit
msgpack-c
app-editors/neovim
app-forensics/foremost
dev-cpp/lucene++
app-i18n/poedit
app-misc/beep
app-misc/far2l
app-office/abiword
kde-misc/calligra
app-office/gnucash
app-office/gnumeric
app-office/libreoffice
app-office/scribus
app-office/unoconv
app-text/psutils
app-text/a2ps
app-text/asciidoc
app-text/dblatex
app-text/editorconfig-core-c
app-text/fbreader
app-text/openjade
app-text/texlive-bin
app-text/linuxdoc-tools
app-text/mupdf
app-text/docbook2x
dev-java/bcprov
strip-nondeterminism
app-text/pdftk
app-text/podofo
app-text/qpdf
app-text/xmldiff
app-text/xpdf
app-text/zathura
media-libs/projectm
media-sound/clementine
sys-power/apcupsd
xorg-apps/xorg-xdm
xorg-libs/libxp
xorg-libs/mesa
net-voip/telepathy-salut
gnome-libs/retro-gtk
gnome-libs/gnome-games
multilib-lib32/lib32-freetype
multilib-lib32/lib32-harfbuzz
multilib-lib32/lib32-libx11
multilib-lib32/lib32-libxcb
app-emulation/libvirt
app-emulation/wine 
media-libs/lilv
media-libs/sratom
media-libs/libjxl
media-libs/libquvi
media-gfx/graphicsmagick
dev-util/vulkan-tools
sci-libs/avogadrolibs
net-fs/cifs-utils
www-client/firefox 
www-client/seamonkey
gnome-libs/telepathy-folks
dev-db/sqlitebrowser
dev-lang/rust"

STARTD=`pwd`
LOGFILE=~/build.log

echo "============================= Начало сборки `date` =============================" >> $LOGFILE

for i in $LIST ; do
    cd $STARTD/$i
    CATEGORY="$(echo $i | cut -d '/' -f 1)"
    if mkpkg -ba -wd ~/mkpkg/build -pod ~/mkpkg/repository/$CATEGORY -si ; then
           echo "`date` || Пакет: $i ГОТОВ" >> $LOGFILE
           cd $STARTD
    else
           echo "`date` || ОШИБКА пакет: $i НЕ СОБРАН!!!" >> $LOGFILE
           cd $STARTD
          # exit
    fi
done

echo "============================= Завершено `date` =============================" >> $LOGFILE

#sudo poweroff
