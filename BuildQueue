#!/bin/bash

# NOTE: Этот скрипт предназначен для организации очереди сборки пакетов
# WARNING: Скрипт не умеер разделять мультипакеты на категории

LIST="dev-lang/rust
media-libs/libjxl
media-libs/libquvi
media-gfx/graphicsmagick
app-text/mupdf
app-text/podofo
dev-util/vulkan-tools
media-libs/mesa"
#sci-libs/avogadrolibs
#media-libs/opencv
#dev-embedded/avr-gcc
#dev-embedded/avr-libc
#libnma-gtk4
#net-vpn/networkmanager-pptp
#pkcs11-helper
#net-vpn/openvpn
#net-vpn/networkmanager-openvpn"

STARTD=`pwd`
LOGFILE=~/build.log

echo "============================= Начало сборки `date` =============================" >> $LOGFILE

for i in $LIST ; do
    cd $STARTD/$i
    CATEGORY="$(echo $i | cut -d '/' -f 1)"
    if mkpkg -ba -pod ~/repository/$CATEGORY -si; then
           echo "`date` || Пакет: $i ГОТОВ" >> $LOGFILE
           cd $STARTD
    else
           echo "`date` || ОШИБКА пакет: $i НЕ СОБРАН!!!" >> $LOGFILE
           cd $STARTD
          # exit
    fi
done

echo "============================= Завершено `date` =============================" >> $LOGFILE

#sudo poweroff
