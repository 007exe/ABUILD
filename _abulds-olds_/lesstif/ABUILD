# ABUILD generated by mkpkg_generator.sh

pkgname=lesstif
pkgver=0.95.2
pkgbuild=1
arch=("auto")

shortdesc=("lesstif (a free replacement for OSF/Motif(R))")
longdesc=("LessTif is the Hungry Programmers' (www.hungry.com) free clone of Motif(R). It aims to be source compatible with OSF/Motif(R) meaning that the same source code should compile with both and work exactly the same. This package contains the libraries and header files to be able to run and compile Motif applications, along with the lesstif version of mwm, the Motif window manager.")

tags=("libs x11-libs")
source=("http://downloads.sourceforge.net/${pkgname}/${pkgname}-${pkgver}.tar.bz2")
build_deps="glibc-solibs libICE libSM libX11 libXau libxcb libXdmcp libXext libXp libXt freetype libXt libXp"

build() {
  go_src_dir
  burn_patches
  ./configure --prefix=/usr \
  --libdir=/usr/lib$LIBDIRSUFFIX \
  --mandir=/usr/man \
  --docdir=/usr/doc/${pkgname}-${pkgver} \
  --sysconfdir=/etc \
  --enable-production \
  --enable-nonstandard-conversions \
  --enable-editres \
  --with-xdnd \
  --with-x \
  --enable-build-21 \
  --disable-debug \
  --enable-static

  # fix linkage against already installed version
  perl -pi -e 's/^(hardcode_into_libs)=.*/$1=no/' libtool
  make -j${numjobs}

  # fix linkage against already installed version
  for f in `find . -name \*.la -type f` ; do
    perl -pi -e 's/^(relink_command=.*)/# $1/' $f
  done

  make -C lib/Mrm-2.1
}

after_build() {
  go_src_dir
  #make -C lib/Mrm-2.1 DESTDIR="${pkgdir}" install
  make appdir=/usr/share/X11/app-defaults docdir=/usr/doc/${pkgname}-${pkgver} rootdir=/usr/doc/${pkgname}-${pkgver} \
    DESTDIR="${pkgdir}" install

  rm -fR "${pkgdir}"/usr/lib$LIBDIRSUFFIX/LessTif
}

