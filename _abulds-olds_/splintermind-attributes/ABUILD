# ABUILD generated by mkpkg_generator.sh

pkgname=splintermind-attributes
pkgver=20.4
pkgbuild=1
arch=("auto")

shortdesc=("Management tool designed to run side-by-side with Dwarf Fortress. Clone of dwarftherapist.")
longdesc=("A fork of DwarfTherapist, with additional features.")
tags=("games games-util")
source=("hg:https://code.google.com/r/splintermind-attributes")
build_deps="cxxlibs gcc glibc-solibs qt4"

build() {
  go_src_dir
  qmake dwarftherapist.pro
  make -j${numjobs}
}

after_build() {
  go_src_dir
  burn_patches
  install -d "${pkgdir}/usr/share/splintermind-attributes/memory_layouts/linux/"
  install -Dm644 LICENSE.txt "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
  install -Dm755 bin/release/DwarfTherapist "${pkgdir}/usr/bin/splintermind-attributes"
  install -Dm644 etc/game_data.ini \
    "${pkgdir}/usr/share/splintermind-attributes/game_data.ini"
  install -Dm644 etc/memory_layouts/linux/*.ini \
    "${pkgdir}/usr/share/splintermind-attributes/memory_layouts/linux/"

#  install -Dm644 "${srcdir}"/*.ini \
#    "${pkgdir}/usr/share/dwarftherapist/memory_layouts/linux/"

  install -Dm644 img/hammer.png \
    "${pkgdir}"/usr/share/icons/hicolor/128x128/apps/splintermind-attributes.png
}
