# ABUILD generated by mkpkg_generator.sh

pkgname=nc
pkgver=1.105
deb_patch=7
pkgbuild=1
arch=("auto")

shortdesc=("Netcat network utility (OpenBSD variant)")
longdesc=("Netcat, or "nc" as the actual program is named, is a simple utility which reads and writes data across network connections, using TCP or UDP protocol. It is designed to be a reliable "back-end" tool that can be used directly or easily driven by other programs and scripts. At the same time, it is a feature-rich network debugging and exploration tool, since it can create almost any kind of connection you would need and has several interesting built-in capabilities. Netcat was written by *Hobbit* <hobbit@avian.org>, and is a product of Avian Research.")
tags=("network net-analyzer")
source=("http://ftp.debian.org/debian/pool/main/n/netcat-openbsd/netcat-openbsd_${pkgver}.orig.tar.gz"
"http://ftp.debian.org/debian/pool/main/n/netcat-openbsd/netcat-openbsd_${pkgver}-${deb_patch}.debian.tar.gz n")
build_deps="glibc-solibs gcc make libbsd"

build() {
  go_src_dir
  tar xf ${srcache}/netcat-openbsd_${pkgver}-${deb_patch}.debian.tar.gz
  for i in `cat debian/patches/series`; do
    echo "** patch $i" 1>&2
    cat "debian/patches/$i"
  done | patch -p1
  make -j${numjobs} \
    CFLAGS="$CFLAGS -DDEBIAN_VERSION=\"\\\"${pkgrel}\\\"\" -I/usr/include/libbsd" \
    LDFLAGS="$LDFLAGS -lbsd"
}

after_build() {
  go_src_dir
  install -Dm0755 nc $pkgdir/usr/bin/nc
  ln -s nc $pkgdir/usr/bin/netcat
  install -Dm0644 nc.1 $pkgdir/usr/man/man1/nc.1
  install -dm0755 $pkgdir/usr/share/licenses/$pkgname/
  head -n28 netcat.c | tail -n+2 >$pkgdir/usr/share/licenses/$pkgname/LICENSE
}