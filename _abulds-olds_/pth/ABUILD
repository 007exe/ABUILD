# ABUILD generated by mkpkg_generator.sh

pkgname=pth
pkgver=2.0.7
pkgbuild=2
arch=("auto")

shortdesc=("pth (GNU Portable Threads)")
longdesc=("Pth is a very portable POSIX/ANSI-C based library for Unix platforms which provides non-preemptive priority-based scheduling for multiple threads of execution (aka 'multithreading') inside event-driven applications. All threads run in the same address space of the server application, but each thread has its own individual program-counter, run-time stack, signal mask and errno variable.")
tags=("dev-libs network")
source=("ftp://ftp.gnu.org/gnu/pth/$pkgname-$pkgver.tar.gz")
build_deps="glibc-solibs gawk"

build() {
  go_src_dir
  ./configure --prefix=/usr \
    --libdir=/usr/lib$LIBDIRSUFFIX \
    --mandir=/usr/man \
    --sysconfdir=/etc \
    --disable-static \
    --enable-shared \
    --with-pic

  sed -i "s|awk=''|awk=/bin/awk|g" shtool # "Cannot find a reasonable Awk"
  make -j1
}

after_build() {
  go_src_dir
  make install DESTDIR=$pkgdir
}
