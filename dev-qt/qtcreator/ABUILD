pkgname=qtcreator
pkgver=11.0.3
pkgbuild=1
arch=("auto")

shortdesc=("Lightweight, cross-platform integrated development environment.")

source=("https://github.com/qt-creator/qt-creator/archive/refs/tags/v${pkgver}.tar.gz")

tags=("dev-qt develop")

# clazy litehtml
adddep=("qt6-tools qt6-svg qt6-quick3d qt6-webengine qt6-serialport qt6-shadertools
qt6-5compat clang yaml-cpp")

build_deps=("${adddep} cmake llvm python")

# NOTE: Это опциональные зависимости
removedep=("qt6-doc qt6-examples gdb cmake x11-ssh-askpass git mercurial bzr valgrind perf mlocate")

build() {
  go_src_dir
  burn_patches
  cmake -B build \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_LIBDIR=lib \
    -DWITH_DOCS=ON \
    -DBUILD_DEVELOPER_DOCS=ON \
    -DBUILD_QBS=OFF \
    -DQTC_CLANG_BUILDMODE_MATCH=ON
  cmake --build build -j${numjobs}
  cmake --build build --target docs
  DESTDIR=${pkgdir} cmake --install build
# Установка документации
  cp -r build/share/doc ${pkgdir}/usr/share

  install -Dm644 LICENSE.GPL3-EXCEPT ${pkgdir}/usr/share/licenses/qtcreator/LICENSE.GPL3-EXCEPT
}
