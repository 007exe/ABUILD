# ABUILD generated by mkpkg_generator.sh

pkgname=love
pkgver=0.8.0
pkgbuild=1
arch=("auto")

shortdesc=("An open-source 2D game engine which uses the versatile Lua scripting language to create dynamic gaming experiences")
tags=("develop games-util")

source=("https://bitbucket.org/rude/love/downloads/love-${pkgver}-linux-src.tar.gz")

build_deps="physfs freetype devil mpg123 openal libvorbis libmodplug sdl shared-mime-info hicolor-icon-theme desktop-file-utils luajit"

BUILD_SYSTEM="autotools"
BUILD_KEYS="--prefix=/usr --libdir=/usr/lib$LIBDIRSUFFIX --mandir=/usr/man --sysconfdir=/etc --with-luajit"
INSTALL_KEYS="DESTDIR=$pkgdir"

after_build() {
  go_src_dir

  make DESTDIR="$pkgdir" install

  mkdir -p "$pkgdir/usr/share/licenses/$pkgname"
  mkdir -p "$pkgdir/usr/share/icons/hicolor/scalable/mimetypes"
  mkdir -p "$pkgdir/usr/share/icons/hicolor/scalable/apps"
  mkdir -p "$pkgdir/usr/share/mime/packages"

  install -Dm0644 "$filedir/license.txt" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
  install -Dm0644 "$filedir/app.svg" "$pkgdir/usr/share/icons/hicolor/scalable/apps/love.svg"
  install -Dm0644 "$filedir/game.svg" "$pkgdir/usr/share/icons/hicolor/scalable/mimetypes/gnome-mime-application-x-love-game.svg"
  install -Dm0644 "$filedir/love.xml" "$pkgdir/usr/share/mime/packages/love.xml"
}