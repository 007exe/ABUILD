pkgname=python-pep517
pkgver=0.12.0
pkgbuild=1
arch=("auto")

shortdesc=("Wrappers to build Python packages using PEP 517 hooks.")
longdesc=("Wrappers to build Python packages using PEP 517 hooks.")

source=("https://pypi.io/packages/source/p/pep517/pep517-$pkgver.tar.gz")

tags=("libs dev-python")

build_deps=("python python-tomli python-setuptools")

adddep=("python-tomli")

build() {
  go_src_dir
# Copied from openSUSE: 
# Remove what appears to be overly cautious flag
# that causes tests to require internet, both here
# and the test suites of any dependencies. Tracking at:
# https://github.com/pypa/pep517/issues/101
  sed -i "s/ '--ignore-installed',//" pep517/envbuild.py
  python setup.py build
  python setup.py install --root="$pkgdir" --optimize=1 --skip-build
  install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}
