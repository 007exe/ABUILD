pkgname=python-yaspin
pkgver=2.1.0
pkgbuild=1
arch=("auto")

shortdesc=("Yet Another Terminal Spinner.")
longdesc=("Yaspin provides a full-featured terminal spinner to show the progress during long-hanging operations.")

source=("https://github.com/pavdmyt/yaspin/archive/v$pkgver/$pkgname-$pkgver.tar.gz")

tags=("libs dev-python")

build_deps=("python python-dephell python-termcolor")

adddep=("python-termcolor")

build(){
  go_src_dir
# poetry-generated setup.py is badly broken in several ways, including
# distribution of tests in the built package as well as using distutils for
# bad metadata. See https://github.com/sdispater/poetry/issues/866
  dephell deps convert --from pyproject.toml --to setup.py

  python setup.py build
  python setup.py install --root="$pkgdir" --optimize=1

  install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}
