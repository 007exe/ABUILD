pkgname=python-sphinx
pkgver=6.1.3
pkgbuild=1
arch=("auto")

shortdesc=("Python documentation generator.")
longdesc=("Sphinx is a tool that facilitates the creation of beautiful documentation for Python projects from reStructuredText sources.")

source=("https://pypi.org/packages/source/S/Sphinx/Sphinx-${pkgver}.tar.gz")

tags=("libs dev-python")

build_deps=("python python-build python-flit-core python-installer python-babel
python-docutils python-imagesize python-jinja python-packaging python-pygments
python-requests python-snowballstemmer python-sphinx-alabaster-theme
python-sphinxcontrib-devhelp python-sphinxcontrib-htmlhelp
python-sphinxcontrib-applehelp python-sphinxcontrib-jsmath
python-sphinxcontrib-qthelp python-sphinxcontrib-serializinghtml")

adddep=("python-babel python-docutils python-imagesize python-jinja
python-packaging python-pygments python-requests python-snowballstemmer
python-sphinx-alabaster-theme python-sphinxcontrib-devhelp
python-sphinxcontrib-htmlhelp python-sphinxcontrib-applehelp
python-sphinxcontrib-jsmath python-sphinxcontrib-qthelp
python-sphinxcontrib-serializinghtml")

# NOTE: Это опциональные зависимости
removedep=("imagemagick texlive-latexextra")

build() {
  go_src_dir
  python -m build --wheel --skip-dependency-check --no-isolation
  python -m installer --destdir=${pkgdir} dist/*.whl
  local site_packages=$(python -c "import site; print(site.getsitepackages()[0])")
  install -d ${pkgdir}/usr/share/licenses/${pkgname}
  ln -s ${site_packages}/sphinx-${pkgver}.dist-info/LICENSE ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
}
