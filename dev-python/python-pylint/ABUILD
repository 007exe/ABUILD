pkgname=python-pylint
pkgver=2.14.5
pkgbuild=1
arch=("auto")

shortdesc=("Analyzes Python code looking for bugs and signs of poor quality.")

source=("https://github.com/PyCQA/pylint/archive/v${pkgver}/pylint-${pkgver}.tar.gz")

tags=("libs dev-python")

build_deps=("python python-build python-installer python-myst-parser python-setuptools python-sphinx python-sphinx-reredirects python-wheel
python-astroid python-colorama python-dill python-isort python-mccabe python-platformdirs python-tomli python-tomlkit")

build() {
  go_src_dir
  burn_patches
  sed -i -e '/>=/{s/>.*//;p}' -e '/python_requires/d' setup.cfg
  sed -i -e '/^markers =/a\    pathdependent: Does not play nice' setup.cfg
  sed -i -e '/test_do_not_import_files_from_local_directory_with_pythonpath/i\    @pytest.mark.pathdependent' tests/test_self.py
  python -m build -wn
#  make PYTHONPATH="$PWD/build/lib" -C doc man
  python -m installer -d ${pkgdir} dist/*.whl
#  install -Dm0644 -t ${pkgdir}/usr/share/man/man1/ doc/_build/man/*.1
}
