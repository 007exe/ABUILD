pkgname=python-docutils
pkgver=0.18.1
pkgbuild=1
arch=("auto")

shortdesc=("Python Documentation Utilities")
longdesc=("The purpose of the Docutils project is to create a set of tools for processing plaintext documentation into useful formats, such as HTML, XML, and LaTeX.")

#source=("https://files.pythonhosted.org/packages/4c/17/559b4d020f4b46e0287a2eddf2d8ebf76318fd3bd495f1625414b052fdc9/docutils-$pkgver.tar.gz")
_name=docutils
source=("https://downloads.sourceforge.net/$_name/$_name-$pkgver.tar.gz")

tags=("dev-python libs")

build_deps=("python python-setuptools")

build() {
  go_src_dir
  python3 setup.py build --build-lib=build/python
  find build/python -type f -exec \
    sed -i '1s,^#! \?/usr/bin/\(env \|\)python$,#!/usr/bin/python3,' {} \;

  python setup.py build --build-lib=build/python \
                  install --root="$pkgdir" --optimize=1
# symlink without .py
  for f in "$pkgdir"/usr/bin/*.py; do
      ln -s "$(basename $f)" "$pkgdir/usr/bin/$(basename $f .py)"
  done
# setup license
  install -D -m644 COPYING.txt "$pkgdir/usr/share/licenses/$pkgname/COPYING.txt"
  install -D -m644 licenses/python* "$pkgdir/usr/share/licenses/$pkgname/"
}
