pkgname=pdftk
pkgver=3.3.2
pkgbuild=1
arch=("auto")

shortdesc=("Command-line tool for working with PDFs.")

source=("https://gitlab.com/pdftk-java/pdftk/-/archive/v$pkgver/$pkgname-v$pkgver.tar.bz2")

tags=("app-text apps")

# ant java-commons-lang
build_deps=("bcprov strip-nondeterminism")

build() {
  go_src_dir
  burn_patches
  mkdir lib
  ln -s /usr/share/java/{bcprov/bcprov,commons-lang/commons-lang,hamcrest-core,junit,junit-system-rules/system-rules}.jar lib
  sed -ri '/<\/?jacoco:coverage>/d' build.xml
  ant clean jar
  install -Dm644 build/jar/pdftk.jar -t ${pkgdir}/usr/share/java/${pkgname}
  install -Dm644 pdftk.1 -t ${pkgdir}/usr/share/man/man1
  install -Dm755 ${filedir}/pdftk.sh ${pkgdir}/usr/bin/pdftk
}
