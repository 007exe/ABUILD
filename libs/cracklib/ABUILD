pkgname=cracklib
pkgver=2.9.7
pkgbuild=2
arch=("auto")

shortdesc=("A password-checking library")
longdesc=("CrackLib tests passwords to determine whether they match certain security-oriented characteristics. You can use CrackLib to stop users from choosing passwords which would be easy to guess.")

tags=("sys-libs libs")

source=("https://github.com/cracklib/cracklib/releases/download/v$pkgver/$pkgname-$pkgver.tar.gz")

build_deps="zlib"

build() {
  go_src_dir
  burn_patches
  ./configure \
    --prefix=/usr \
    --sbindir=/usr/bin \
    --libdir=/usr/lib$LIBDIRSUFFIX \
    --without-python
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
# symlink cracklib-small #34778
  mkdir -p "$pkgdir"/usr/share/dict
  ln -sf /usr/share/cracklib/cracklib-small "$pkgdir"/usr/share/dict/cracklib-small
  sh ./util/cracklib-format dicts/cracklib-small \
    | sh ./util/cracklib-packer "$pkgdir"/usr/share/cracklib/pw_dict
}
