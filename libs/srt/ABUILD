pkgname=srt
pkgver=1.4.3
pkgbuild=1
arch=("auto")

shortdesc=("Secure Reliable Transport library")
longdesc=("Secure Reliable Transport library")

source=("https://github.com/Haivision/srt/archive/refs/tags/v${pkgver}.tar.gz")

tags="libs net-libs"

build_deps="openssl cmake"

build() {
  go_src_dir
  burn_patches
  cmake -B build \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_BINDIR=bin \
    -DCMAKE_INSTALL_LIBDIR=lib${LIBDIRSUFFIX} \
    -DCMAKE_INSTALL_INCLUDEDIR=include \
    -DCMAKE_BUILD_TYPE=None \
    -DENABLE_STATIC=ON \
    -DENABLE_TESTING=ON
  cmake --build build

  DESTDIR="$pkgdir" cmake --install build
  rm "$pkgdir"/usr/bin/{uriparser,utility}-test
}
