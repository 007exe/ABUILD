# ABUILD generated by mkpkg_generator.sh

pkgname=libtermcap
pkgbase=termcap
pkgver=1.3.1
pkgbuild=1
arch=("auto")

shortdesc=("Enables programs to use display computer terminals in a device-independent manner")
longdesc=("This is the GNU termcap library -- a library of C functions that enable programs to send control strings to terminals in a way independent of the terminal type. Most of this package is also distributed with GNU Emacs, but it is available in this separate distribution to make it easier to install as -ltermcap.")

tags=("sys-libs libs compat32")

source=("http://ftp.gnu.org/gnu/${pkgbase}/${pkgbase}-${pkgver}.tar.gz")
build_deps="glibc-solibs"

build() {
  go_src_dir
  burn_patches
  ./configure --prefix=/usr

  make -j${numjobs}

  gcc -fPIC -c "${pkgbase}.c" -o "${pkgbase}.o" \
    -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DSTDC_HEADERS=1 || return 1
  gcc -shared -Wl,-soname,"${pkgname}.so" \
    -o "${pkgname}.so.${pkgver}" "${pkgbase}.o" || return 1
}

after_build() {
  go_src_dir
  make prefix=$pkgdir/usr libdir=$pkgdir/usr/lib${LIBDIRSUFFIX} oldincludedir=$pkgdir/usr/include install
  install -D -m755 "${pkgname}.so.${pkgver}" "${pkgdir}/lib${LIBDIRSUFFIX}/${pkgname}.so.${pkgver}"
  ln -s "/lib${LIBDIRSUFFIX}/${pkgname}.so.${pkgver}" "${pkgdir}/usr/lib${LIBDIRSUFFIX}/${pkgname}.so.${pkgver}"
  ln -s "${pkgname}.so.${pkgver}" "${pkgdir}/usr/lib${LIBDIRSUFFIX}/${pkgname}.so"
}