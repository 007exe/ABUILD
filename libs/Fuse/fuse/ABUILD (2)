# ABUILD generated by mkpkg_generator.sh

pkgname=fuse
pkgver=2.9.9
pkgbuild=1
arch=("auto")

shortdesc=("FUSE (Filesystem in Userspace)")
longdesc=("FUSE is a simple interface for userspace programs to export a virtual filesystem to the Linux kernel. FUSE also aims to provide a secure method for non privileged users to create and mount their own filesystem implementations. The FUSE web site can be found here: http://fuse.sourceforge.net")

tags=("libs sys-fs")

source=("https://github.com/libfuse/libfuse/releases/download/fuse-$pkgver/$pkgname-$pkgver.tar.gz")
build_deps="glibc"

BUILD_SYSTEM="autotools"
BUILD_KEYS="--prefix=/usr --enable-lib --libdir=/lib${LIBDIRSUFFIX} --enable-util --bindir=/bin"
INSTALL_KEYS="DESTDIR=$pkgdir"
config_files="etc/fuse.conf"
after_build() {
	
	# static device nodes will cause collision.
	rm -rf ${pkgdir}/dev
 
	# Remove init script in wrong path
	# Don't add our own for now, as fusectl fs oopses on 2.6.18
	rm -rf ${pkgdir}/etc/init.d

	# install sample config file
	install -Dm644 ${filedir}/fuse.conf ${pkgdir}/etc/fuse.conf
	# Fix udev rule location
	install -d -m755 "${pkgdir}/lib"

	mv "${pkgdir}/etc/udev" "${pkgdir}/lib/"

	# Fix pkgconfig location
	mkdir -p ${pkgdir}/usr/lib${LIBDIRSUFFIX}
	mv ${pkgdir}/lib${LIBDIRSUFFIX}/pkgconfig ${pkgdir}/usr/lib${LIBDIRSUFFIX}/

}

