pkgname=fuse3
pkgver=3.10.4
pkgbuild=1
arch=("auto")

shortdesc=("Interface for userspace programs to export a virtual filesystem to the kernel")
longdesc=("FUSE (Filesystem in USErspace) is a simple interface for userspace programs to export a virtual filesystem to the linux kernel. FUSE also aims to provide a secure method for non privileged users to create and mount their own filesystem implementations.")

tags=("libs sys-fs")

source=("https://github.com/libfuse/libfuse/releases/download/fuse-$pkgver/fuse-$pkgver.tar.xz")

build_deps="pkg-config eudev meson"

adddep="fuse-common"

build() {
  go_src_dir

  rm -rf build
  meson --prefix=/usr --libdir=/usr/lib${LIBDIRSUFFIX} --sbindir=bin -D examples=false . build
  cd build
  ninja

  DESTDIR=${pkgdir} ninja install

  rm -r ${pkgdir}/etc/fuse.conf
  rm -r ${pkgdir}/etc/init.d

# static device nodes are handled by udev
  rm -r ${pkgdir}/dev
}
