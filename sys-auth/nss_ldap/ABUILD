pkgname=nss_ldap
pkgver=265
pkgbuild=1
arch=("auto")

shortdesc=("The nss_ldap module provides the means for Linux and Solaris workstations to resolve the entities defined in RFC 2307 from LDAP directories.")

source=("https://fossies.org/linux/privat/old/${pkgname}-${pkgver}.tar.gz")

tags=("sys-auth network")

# libldap
build_deps=("krb5")

config_files=("etc/nss_ldap.conf")

build() {
  go_src_dir
  burn_patches
  export PERL5LIB="$PWD"
  ./configure \
    --prefix=/usr \
    --with-ldap-conf-file=/etc/nss_ldap.conf \
    --with-ldap=openldap \
    --sysconfdir=/etc \
    --mandir=/usr/share/man \
    --enable-schema-mapping \
    --enable-rfc2307bis \
    --enable-configurable-krb5-ccname-gssapi
  env PATH=`pwd`:"$PATH" make
  make DESTDIR=${pkgdir} install
  rm -rf ${pkgdir}/usr/usr
}
