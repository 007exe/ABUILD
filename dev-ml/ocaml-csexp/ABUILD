pkgname=ocaml-csexp
pkgver=1.3.2
pkgbuild=1
arch=('auto')

shortdesc=("OCaml canonical S-expressions")
longdesc=("This project provides minimal support for parsing and printing S-expressions in canonical form, which is a very simple and canonical binary encoding of S-expressions.")

source=("https://github.com/ocaml-dune/csexp/archive/${pkgver}/${pkgname}-${pkgver}.tar.gz")

tags="develop dev-util"

build_deps="ocaml ocaml-findlib ocaml-result dune"

adddep="ocaml"

build()
{
  go_src_dir
  burn_patches
  dune build -p csexp
  DESTDIR="${pkgdir}" dune install --prefix "/usr" --libdir "lib${LIBDIRSUFFIX}/ocaml"

  install -dm755 "${pkgdir}/usr/share/"
  mv "${pkgdir}/usr/doc" "${pkgdir}/usr/share/"

  install -dm755 "${pkgdir}/usr/share/licenses/${pkgname}"
  ln -s /usr/share/doc/csexp/LICENSE.md "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
