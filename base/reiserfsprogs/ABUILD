pkgname=reiserfsprogs
pkgver=3.6.27
pkgbuild=2
arch=("auto")

shortdesc="The utilities to create reiserfs volumes"
longdesc="This package contains tools for reiserfs filesystems. Reiserfs is a file system using a plug-in based object oriented variant on classical balanced tree algorithms."

tags=("base sys-fs")

source=("https://mirrors.edge.kernel.org/pub/linux/kernel/people/jeffm/reiserfsprogs/v${pkgver}/reiserfsprogs-${pkgver}.tar.xz")

build_deps="make coreutils gcc kernel-headers grep util-linux-ng"

build() {
  go_src_dir
  burn_patches
  sed -i '/parse_time.h/i #define _GNU_SOURCE' lib/parse_time.c
  autoreconf -fiv
  CFLAGS+=' -fgnu89-inline'
  ./configure \
    --prefix=/usr \
    --sbindir=/usr/bin \
    --libdir=/usr/lib${LIBDIRSUFFIX}
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}
