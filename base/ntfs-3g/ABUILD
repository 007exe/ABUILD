pkgname=ntfs-3g
pkgver=2017.3.23
pkgbuild=1
arch=('auto')

shortdesc="Free and open source NTFS driver for Linux."

source="http://tuxera.com/opensource/ntfs-3g_ntfsprogs-${pkgver}.tgz"

tags="base sys-fs"

build_deps="make gcc pkg-config autoconf coreutils binutils util-linux-ng fuse sed grep"

before_build() {
        go_src_dir
        burn_patches
	sed 's|$(DESTDIR)/sbin|$(DESTDIR)/usr/bin|' -i {ntfsprogs,src}/Makefile.in
}


build(){
  go_src_dir
	./configure \
            --prefix=/usr \
            --disable-static \
	    --disable-ldconfig \
	    --enable-xattr-mappings \
	    --enable-crypto \
            --mandir=/usr/share/man \
            --docdir=/usr/share/doc \
            --libdir=/usr/lib${LIBDIRSUFFIX} \
            --with-fuse=external \
            --enable-posix-acls \
            --enable-extras

  make -j${numjobs}

      make DESTDIR="${pkgdir}" rootbindir=/usr/bin rootsbindir=/usr/bin rootlibdir=/usr/lib${LIBDIRSUFFIX} install

	ln -s /usr/bin/ntfs-3g ${pkgdir}/usr/bin/mount.ntfs
}
