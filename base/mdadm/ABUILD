pkgname=mdadm
pkgver=4.1
pkgbuild=3
arch=("auto")

shortdesc=("A tool for managing Soft RAID under Linux.")
longdesc=("Mdadm is a program that can be used to create, manage, and monitor Linux MD (Software RAID) devices.")

tags=("base sys-fs")

source=("https://mirrors.edge.kernel.org/pub/linux/utils/raid/mdadm/mdadm-$pkgver.tar.xz")

config_files="etc/mdadm.conf"

build_deps="glibc"

build() {
  go_src_dir
  burn_patches
  sed -i "s,-Werror,," Makefile
  make CXFLAGS="$CFLAGS" BINDIR=/usr/bin UDEVDIR=/usr/lib/udev MANDIR=/usr/share/man
  make INSTALL=/usr/bin/install BINDIR=/usr/bin DESTDIR=${pkgdir} UDEVDIR=/usr/lib/udev install

  install -Dm0644 mdadm.conf-example ${pkgdir}/etc/mdadm.conf
  mkdir ${pkgdir}/etc/init.d/
  install -Dm755  ${filedir}/mdadm ${pkgdir}/etc/init.d/
}
