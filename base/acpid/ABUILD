pkgname=acpid
pkgver=2.0.32
pkgbuild=2
arch=('auto')

shortdesc="ACPI kernel daemon and control utility"
longdesc="The ACPI specification defines power and system management functions for each computer, in a generic manner. The ACPI daemon coordinates the management of power and system functions when ACPI kernel support is enabled (kernel 2.3.x or later)."

tags=('base sys-power')

source=("http://downloads.sourceforge.net/sourceforge/acpid2/$pkgname-$pkgver.tar.xz")

build_deps='glibc'
config_files="etc/acpi/acpi_handler.sh
etc/conf.d/acpid
etc/acpi/events/default"

build() {
  go_src_dir
  ./configure \
    --prefix=/usr
  make -j${numjobs}
  make DESTDIR="$pkgdir" install
}

after_build(){
  mkdir -p $pkgdir/etc/acpi/events
  zcat $filedir/acpi_handler.sh.gz > $pkgdir/etc/acpi/acpi_handler.sh
  chmod 755 $pkgdir/etc/acpi/acpi_handler.sh
  zcat $filedir/default.gz > $pkgdir/etc/acpi/events/default

# Add OpenRC scripts
  install -Dm644 $filedir/acpid $pkgdir/etc/conf.d/acpid
  install -Dm755 $filedir/acpid.init $pkgdir/etc/init.d/acpid
}

