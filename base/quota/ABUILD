# ABUILD generated by mkpkg_generator.sh

pkgname=quota
pkgver=4.05
pkgbuild=2
arch=("auto")

shortdesc=("quota (Linux disk quota utilities)")
longdesc=("An implementation of the diskquota system for the Linux operating system to keep those greedy users from gobbling up 100% of the hard drive space. Works with ext2, ext3, reiserfs, and xfs filesystems. This system is based on the Melbourne quota system by Robert Elz. Edvard Tuinder and Marco van Wieringen ported this code to Linux. Jan Kara added support for the new Linux quota format and the XFS filesystem.")

tags=("base sys-fs")

source=("http://downloads.sourceforge.net/sourceforge/linuxquota/${pkgname}-${pkgver}.tar.gz")

build_deps="e2fsprogs glibc"

build() {
  go_src_dir
  ./configure --prefix=/usr \
		--libdir=/usr/lib$LIBDIRSUFFIX \
		--mandir=/usr/share/man \
		--sbindir=/usr/bin \
		--sysconfdir=/etc
}


after_build() {
  go_src_dir
  make DESTDIR="$pkgdir" sbindir=/usr/bin root_sbindir=/usr/bin STRIP="" install
  install -D -m0644 ${filedir}/quota.rc ${pkgdir}/etc/init.d/quota
  install -D -m0644 ${filedir}/quota.confd ${pkgdir}/etc/conf.d/quota
  install -D -m0644 ${filedir}/rpc.rquotad.initd ${pkgdir}/etc/init.d/rpc.quotad

  # remove conflicts with glibc
  #rm "${pkgdir}"/usr/include/rpcsvc/rquota.{h,x}
}
