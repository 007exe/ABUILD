pkgname=vim
pkgver=8.2.3441
pkgbuild=1
arch=('auto')

shortdesc=("The VIM editor")
longdesc=("VIM (VIsual editor iMproved) is an updated and improved version of the vi editor. Vi was the first real screen-based editor for UNIX, and is still very popular. VIM improves on vi by adding new features: multiple windows, multi-level undo, block highlighting and more.")

tags=('app-editors console')

source=("https://github.com/vim/vim/archive/v${pkgver}.tar.gz"
"ftp://ftp.vim.org/pub/vim/runtime/spell/ru.cp1251.spl"
"ftp://ftp.vim.org/pub/vim/runtime/spell/ru.cp1251.sug"
"ftp://ftp.vim.org/pub/vim/runtime/spell/ru.koi8-r.spl"
"ftp://ftp.vim.org/pub/vim/runtime/spell/ru.koi8-r.sug"
"ftp://ftp.vim.org/pub/vim/runtime/spell/ru.utf-8.spl"
"ftp://ftp.vim.org/pub/vim/runtime/spell/ru.utf-8.sug"
"ftp://ftp.vim.org/pub/vim/runtime/spell/en.ascii.spl"
"ftp://ftp.vim.org/pub/vim/runtime/spell/en.ascii.sug"
"ftp://ftp.vim.org/pub/vim/runtime/spell/en.latin1.spl"
"ftp://ftp.vim.org/pub/vim/runtime/spell/en.latin1.sug"
"ftp://ftp.vim.org/pub/vim/runtime/spell/en.utf-8.spl"
"ftp://ftp.vim.org/pub/vim/runtime/spell/en.utf-8.sug")

build_deps="glibc libgcrypt gpm python ruby gawk tcl pcre zlib"

config_files="etc/vimrc"

build() {
  go_src_dir
  ./configure \
    --prefix=/usr \
    --with-features=huge \
    --with-compiledby='Arch Linux' \
    --enable-gpm \
    --enable-acl \
    --with-x=no \
    --disable-gui \
    --enable-multibyte \
    --enable-cscope \
    --enable-netbeans \
    --enable-perlinterp=dynamic \
    --enable-pythoninterp=dynamic \
    --enable-python3interp=dynamic \
    --enable-rubyinterp=dynamic \
    --enable-luainterp=dynamic \
    --enable-tclinterp=dynamic \
    --disable-canberra \
    --with-compiledby="AgiliaLinux"
  make -j${numjobs}
  make install DESTDIR=$pkgdir

# install locale
  install -Dm 644 ${srcache}/ru.cp1251.spl ${pkgdir}/share/vim/vimfiles/spell/ru.cp1251.spl
  install -Dm 644 ${srcache}/ru.cp1251.sug ${pkgdir}/share/vim/vimfiles/spell/ru.cp1251.sug
  install -Dm 644 ${srcache}/ru.koi8-r.spl ${pkgdir}/share/vim/vimfiles/spell/ru.koi8-r.spl
  install -Dm 644 ${srcache}/ru.koi8-r.sug ${pkgdir}/share/vim/vimfiles/spell/ru.koi8-r.sug
  install -Dm 644 ${srcache}/ru.utf-8.spl ${pkgdir}/share/vim/vimfiles/spell/ru.utf-8.spl
  install -Dm 644 ${srcache}/ru.utf-8.sug ${pkgdir}/share/vim/vimfiles/spell/ru.utf-8.sug
  install -Dm 644 ${srcache}/en.ascii.spl ${pkgdir}/share/vim/vimfiles/spell/en.ascii.spl
  install -Dm 644 ${srcache}/en.ascii.sug ${pkgdir}/share/vim/vimfiles/spell/en.ascii.sug
  install -Dm 644 ${srcache}/en.latin1.spl ${pkgdir}/share/vim/vimfiles/spell/en.latin1.spl
  install -Dm 644 ${srcache}/en.latin1.sug ${pkgdir}/share/vim/vimfiles/spell/en.latin1.sug
  install -Dm 644 ${srcache}/en.utf-8.spl ${pkgdir}/share/vim/vimfiles/spell/en.utf-8.spl
  install -Dm 644 ${srcache}/en.utf-8.sug ${pkgdir}/share/vim/vimfiles/spell/en.utf-8.sug

# license
  install -Dm 644 runtime/doc/uganda.txt ${pkgdir}/usr/share/licenses/vim/license.txt

# config file
  install -Dm 644 ${filedir}/vimrc ${pkgdir}/etc/vimrc
}
