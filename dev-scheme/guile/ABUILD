pkgname=guile
pkgver=3.0.9
pkgbuild=1
arch=("auto")

shortdesc=("Portable, embeddable Scheme implementation written in C.")

source=("https://ftp.gnu.org/pub/gnu/$pkgname/${pkgname}-${pkgver}.tar.gz")

tags=("dev-scheme develop")

adddep=("gmp ncurses libunistring gc libffi libxcrypt")

build_deps=("${adddep} texinfo")

build() {
  go_src_dir
  burn_patches
  ./configure \
    --prefix=/usr \
    --disable-static  \
    --disable-error-on-warning
  sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
  rm ${pkgdir}/usr/lib/libguile-3.?.so.*-gdb.scm
}
