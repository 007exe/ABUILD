pkgname=libgphoto2
pkgver=2.5.27
pkgbuild=1
arch=('auto')

shortdesc=("Digital camera access library")
longdesc=("The gPhoto2 project is a universal, free application and library framework that lets you download images from several different digital camera models, including the newer models with USB connections.")

source=("https://github.com/gphoto/libgphoto2/releases/download/v${pkgver}/libgphoto2-${pkgver}.tar.gz")

tags=("libs media-libs")
# libltdl
build_deps="libexif libjpeg-turbo gd libusb libxml2 curl autoconf"

build() {
  go_src_dir
  burn_patches
  autoreconf -fvi
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --disable-rpath \
    --disable-static
  make -j${numjobs}
# Make sure udev helper scripts are put in the right place and
# install the other utilities to /usr/bin instead of /usr/lib/libgphoto2/
  make -j${numjobs} \
  udevscriptdir=/lib/udev \
  utilsdir=/usr/bin \
  || make \
  udevscriptdir=/lib/udev \
  utilsdir=/usr/bin \
  || exit 1
  make \
  udevscriptdir=/lib/udev \
  utilsdir=/usr/bin \
  DESTDIR=${pkgdir} install
}
