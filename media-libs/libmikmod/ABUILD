pkgname=libmikmod
pkgver=3.3.11.1
pkgbuild=1
arch=("auto")

shortdesc=("Module player library supporting many formats, including MOD, S3M, IT and XM.")

source=("https://downloads.sourceforge.net/mikmod/libmikmod-${pkgver}.tar.gz")

tags=("media-libs libs")

adddep=("glibc libpulse bash")

build_deps=("${adddep} alsa-lib cmake ninja")

build() {
  go_src_dir
  burn_patches
  cmake -B build -G Ninja \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_LIBDIR=lib \
    -DCMAKE_BUILD_TYPE=None \
    -DENABLE_DL=1
  cmake --build build
  DESTDIR=${pkgdir} cmake --install build
  install -Dt ${pkgdir}/usr/share/aclocal -m644 libmikmod.m4
  install -Dt ${pkgdir}/usr/share/doc/${pkgname} -m644 {NEWS,README,TODO} build/docs/mikmod.html
  install -Dt ${pkgdir}/usr/share/info build/docs/mikmod.info
  install -Dt ${pkgdir}/usr/share/man/man1 build/docs/libmikmod-config.1
}
