pkgname=gst-plugins-bad
pkgver=1.18.5
pkgbuild=3
arch=("auto")

shortdesc=("Multimedia graph framework - bad plugins")
longdesc=("The GStreamer Bad Plug-ins package contains a set of plug-ins that aren't up to par compared to the rest. They might be close to being good quality, but they're missing something - be it a good code review, some documentation, a set of tests, a real live maintainer, or some actual wide use.")

source=("http://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-${pkgver}.tar.xz")

tags=("libs media-libs")
# mjpegtools chromaprint libmms libdca libgme libkate libofa libsrtp wildmidi faac soundtouch spandsp webrtc-audio-processing libdc1394 zvbi libbs2b libnice bluez-libs liblrdf zbar
# lilv lv2 libavtp svt-hevc libmicrodns zxing-cpp opencv wpewebkit vulkan-validation-layers
build_deps=("meson bluez libx11 python libass gobject-introspection bzip2 cairo openssl curl libdrm glib2 gst-plugins-base gst-plugins-base-libs gstreamer libgudev lcms2 libmodplug openjpeg2 opus orc pango librsvg rtmpdump sbc libsndfile srt libusb libva wayland wayland-protocols libwebp x265 libxml2 libexif libssh2 libxkbcommon libxkbcommon-x11 nettle libgcrypt openjpeg2 sdl2 valgrind gsm ladspa gtk3 vulkan-headers vulkan-icd-loader faad2 libdvdnav libdvdread openal libfdk-aac neon libmpcdec openexr lcms2 bluez glu aom libde265 fluidsynth gst-plugins-good shaderc")

adddep=("libvdpau libxkbcommon-x11")

build() {
  go_src_dir
  burn_patches
  meson build \
    -D prefix=/usr \
    -D directfb=disabled \
    -D doc=disabled \
    -D flite=disabled \
    -D gsm=disabled \
    -D iqa=disabled \
    -D magicleap=disabled \
    -D msdk=disabled \
    -D openh264=disabled \
    -D openmpt=disabled \
    -D openni2=disabled \
    -D opensles=disabled \
    -D tinyalsa=disabled \
    -D voaacenc=disabled \
    -D voamrwbenc=disabled \
    -D wasapi2=disabled \
    -D wasapi=disabled \
    -D gobject-cast-checks=disabled \
    -D package-name="GStreamer Bad Plugins (AgiliaLinux)"
  meson compile -C build
  meson install -C build --destdir "$pkgdir"
}
