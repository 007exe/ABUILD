pkgname=xine-lib
pkgver=1.2.12
pkgbuild=1
arch=("auto")

shortdesc=("Multimedia playback engine.")
longdesc=("Core libraries for Xine movie player.")

source=("https://downloads.sourceforge.net/project/xine/xine-lib/${pkgver}/xine-lib-${pkgver}.tar.xz")

tags=("libs media-libs")

# smbclient
build_deps=("mesa libdvdnav libdvdread vcdimager glu sdl wayland aalib a52dec faad2 flac
libdca libmad libmpcdec wavpack gdk-pixbuf imagemagick libcaca libmng libnfs
ffmpeg libjpeg-turbo libnsl libpng libx11 libxcb libxext libxinerama libxv libxvmc zlib")

# NOTE: Это опциональные зависимости
removedep=("libdvdnav libdvdread vcdimager glu sdl wayland aalib a52dec faad2 flac libdca
libmad libmpcdec wavpack gdk-pixbuf imagemagick libcaca libmng libnfs libssh2 smbclient")

build() {
  go_src_dir
  burn_patches
  ./autogen.sh \
    --prefix='/usr' \
    --enable-antialiasing \
    --with-external-dvdnav \
    --with-wavpack
  sed -i 's/ -shared / -Wl,-O1,--as-needed\0/g' libtoo
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}
