pkgname=openal
pkglist=("openal-examples")
pkgver=1.22.2
strict_version=1
pkgbuild=1
arch=("auto")

shortdesc=("Cross-platform 3D audio library, software implementation.")

source=("git:https://github.com/kcat/openal-soft.git")

tags=("libs media-libs")

build_deps=("alsa-lib cmake ffmpeg fluidsynth git jack libmysofa
libpulse libsndfile ninja pipewire portaudio qt5-base sdl2 gcc-libs")

# NOTE: Это опциональные зависимости
removedep=("qt5-base fluidsynth libmysofa")

build() {
  go_src_dir
  burn_patches
  cd build
  cmake .. \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_LIBDIR=lib \
    -DCMAKE_BUILD_TYPE=None
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}

openal-examples() {
  pkgname=openal-examples
  shortdesc=("Cross-platform 3D audio library, software implementation example programs")
  adddep=(openal=${pkgver} sdl2 libsndfile ffmpeg)
}

openal-examples_prep() {
  mkdir -p $pkgdir/usr/bin
  mv ${p_pkgdir}/usr/bin/al{ffplay,hrtf,latency,loopback,multireverb,play,record,reverb,stream,tonegen} $pkgdir/usr/bin
}
