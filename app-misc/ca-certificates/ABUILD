# NOTE: У меня много вопросов к этому пакету, возможно стоит заменить его на make-ca
pkgname=ca-certificates
pkgver=20210119
pkgbuild=2
arch=("noarch")

shortdesc=("Common CA certificates.")
longdesc=("Common CA certificates.")

source=("http://ftp.debian.org/debian/pool/main/c/${pkgname}/${pkgname}_${pkgver}.tar.xz")

tags=("network net-misc")

build_deps=("python")

adddep=("bash openssl coreutils sed findutils")

config_files=("etc/ca-certificates.conf")

build(){
  go_src_dir
  make
  install -d -m755 ${pkgdir}/{etc/ca-certificates/update.d,usr/{sbin,share/ca-certificates},etc/ssl/certs}
  make install DESTDIR=${pkgdir}
  install -D -m644 sbin/update-ca-certificates.8 ${pkgdir}/usr/share/man/man8/update-ca-certificates.8
(
  echo "# Automatically generated by ${pkgname}-${pkgver}-${pkgbuild}"
  echo "# see update-ca-certificates man page"
  echo "# "
  cd ${pkgdir}/usr/share/ca-certificates
  find . -name '*.crt' | sort | cut -b3-
  ) > ${pkgdir}/etc/ca-certificates.conf

# FIXME:
  mv ${pkgdir}/usr/sbin ${pkgdir}/usr/bin
}
