pkgname=obs-studio
pkgver=27.1.3
pkgbuild=1
arch=('auto')

shortdesc=("Free, open source software for live streaming and recording.")
longdesc=("Free and open source software for video recording and live streaming.")

source=("https://github.com/jp9000/obs-studio/archive/$pkgver.tar.gz")

tags="media-video xapps"

#-DENABLE_PIPEWIRE=ON | pipewire
build_deps="cmake x264 swig python libfdk-aac luajit sndio ffmpeg curl jack jansson libxinerama libxkbcommon-x11 libxcomposite mbedtls qt5-svg"

build() {
  go_src_dir
  burn_patches
  mkdir -p build
  cd build
  cmake ..\
    -DCMAKE_INSTALL_PREFIX="/usr" \
    -DCMAKE_INSTALL_LIBDIR=lib${LIBDIRSUFFIX} \
    -DBUILD_BROWSER=OFF \
    -DBUILD_VST=OFF \
    -DDISABLE_VLC=ON \
    -DENABLE_PIPEWIRE=OFF \
    -DOBS_VERSION_OVERRIDE="$pkgver-$pkgbuild"
  make -j${numjobs}
  make install DESTDIR="$pkgdir"
}
