pkgname=smplayer
pkgver=22.7.0
pkgbuild=1
arch=("auto")

shortdesc=("Great Qt GUI front-end for mplayer/mpv.")
longdesc=("Media player with built-in codecs that can play virtually all video and audio formats.")

source=("https://github.com/smplayer-dev/${pkgname}/releases/download/v$pkgver/${pkgname}-${pkgver}.tar.bz2")

tags=("apps media-video")

build_deps=("qt5-tools glibc qt5-base mpv libx11 zlib gcc-libs")

adddep=("mpv hicolor-icon-theme")

# NOTE: Это опциональные зависимости
removedep=("smplayer-themes smplayer-skins smtube youtube-dl yt-dlp mplayer")

build() {
  go_src_dir
  burn_patches
  sed '/gzip -9/d' -i Makefile
  export CXXFLAGS="${CXXFLAGS} ${CPPFLAGS}"
  make \
    PREFIX=/usr \
    DOC_PATH="\\\"/usr/share/doc/smplayer\\\"" \
    QMAKE_OPTS=DEFINES+=NO_DEBUG_ON_CONSOLE \
    CFLAGS_EXTRA="${CFLAGS} ${CPPFLAGS} ${LDFLAGS}" \
    all
  make \
    PREFIX=/usr \
    DOC_PATH=/usr/share/doc/smplayer \
    DESTDIR=${pkgdir} \
    install
}
