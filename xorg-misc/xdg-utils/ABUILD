pkgname=xdg-utils
pkgver=1.1.3+25+g8ae0263
# NOTE: Коммит версии
_commit=8ae02631a9806da11b34cd6b274af02d28aee5da
strict_version=1
pkgbuild=1
arch=("noarch")

shortdesc=("Command line tools that assist applications with a variety of desktop integration tasks")
longdesc=("Is a set of command line tools that assist applications with a variety of desktop integration tasks.")

#source=("https://portland.freedesktop.org/download/xdg-utils-${pkgver}.tar.gz")
source=("git:https://gitlab.freedesktop.org/xdg/xdg-utils.git")

tags=("xorg-base xorg")

build_deps=("which file xorg-xset xorg-xprop docbook-xsl xmlto lynx")

adddep=("bash xorg-xprop xorg-xset")


# NOTE: Переходим к коммиту
# FIXME: mkpkg не умеет самостоятельно переключаться по веткам и коммитам
before_build() {
  go_src_dir
  git checkout $_commit
}

build() {
  go_src_dir
  burn_patches
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib \
    --with-fop \
    --mandir=/usr/share/man
  make -j${numjobs}
  make DESTDIR=${pkgdir} install

  install -D -m644 LICENSE ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE

# install empty directory to prevent xdg-desktop-menu install *.desktop to fail, see FS#33316
  install -dm755 ${pkgdir}/usr/share/desktop-directories
}
