pkgname=groff
pkgver=1.22.4
pkgbuild=3
arch=("auto")

shortdesc="GNU troff text-formatting system"
longdesc="The GNU groff package provides versions of troff, nroff, eqn, tbl, and other Unix text-formatting utilities. Groff is used to 'compile' man pages stored in groff/nroff format into a form which can be printed or displayed on the screen."

tags=("console app-text")


source=("ftp://ftp.gnu.org/gnu/groff/groff-$pkgver.tar.gz")

build_deps="perl gcc-libs"

build() {
  go_src_dir
  burn_patches
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --without-x \
    --with-appresdir=/usr/share/X11/app-defaults
  make -j${numjobs}
  make DESTDIR=${pkgdir} install

# add compatibility symlinks
  cd $pkgdir/usr/bin
  ln -s eqn geqn
  ln -s tbl gtbl
  ln -s soelim zsoelim
  rm -rf $pkgdir/usr/lib${LIBDIRSUFFIX}/groff/site-tmac

# Fix some issues when encoding to utf8 man pages
#  The output chars don't match keyboard chars...
  cat $filedir/site.tmac >> $pkgdir/usr/share/groff/site-tmac/man.local
  cat $filedir/site.tmac >> $pkgdir/usr/share/groff/site-tmac/mdoc.local

}


