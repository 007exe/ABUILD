pkgname=yaml-cpp
pkgver=0.7.0
pkgbuild=1
arch=("auto")

shortdesc=("YAML parser and emitter in C++, written around the YAML 1.2 spec.")
longdesc=("YAML parser and emitter in C++, written around the YAML 1.2 spec.")

tags=("libs dev-cpp")

source=("https://github.com/jbeder/yaml-cpp/archive/yaml-cpp-${pkgver}.tar.gz")

build_deps="gcc-libs glibc cmake ninja"

build() {
  go_src_dir
  burn_patches
  cmake -GNinja \
        -Bbuild \
        -DCMAKE_INSTALL_PREFIX=/usr \
        -DBUILD_SHARED_LIBS=ON \
        -DYAML_BUILD_SHARED_LIBS=ON \
        -DCMAKE_BUILD_TYPE=Release
  ninja -C build

  DESTDIR="$pkgdir" ninja -C build install
  install -vDm 644 {CONTRIBUTING,README}.md -t "$pkgdir/usr/share/doc/$pkgname"
  install -vDm 644 LICENSE -t "$pkgdir/usr/share/licenses/$pkgname"
  rm -rf "${pkgdir}"/usr/{lib${LIBDIRSUFFIX},lib${LIBDIRSUFFIX}/pkgconfig,include}/*{gtest,gmock}*
  rm -rf "${pkgdir}"/usr/lib${LIBDIRSUFFIX}/cmake/GTest
}
