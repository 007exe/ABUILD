pkgname=i3status
pkgver=2.13
pkgbuild=1
arch=('auto')

shortdesc=("Generates status bar to use with i3bar, dzen2 or xmobar")
longdesc=("i3status is a small program for filling dzen2 or wmii status bar via its 9P pseudo filesystem.")

source=("https://i3wm.org/i3status/i3status-$pkgver.tar.bz2")

tags="x11-wm xapps"

build_deps="alsa-lib libnl yajl confuse libpulse asciidoc xmlto"

config_files="etc/i3status.conf"

build(){
  go_src_dir
  burn_patches
  autoreconf --force --install
  mkdir build && cd build
  ../configure \
    --prefix=/usr \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --sysconfdir=/etc \
    --disable-sanitizers
# See https://lists.archlinux.org/pipermail/arch-dev-public/2013-April/024776.html
  make CPPFLAGS+="-U_FORTIFY_SOURCE"
  make DESTDIR=${pkgdir} install

  install -Dm644 -t "$pkgdir"/usr/share/licenses/$pkgname ../LICENSE
}
