pkgname=ocaml
pkgver=5.0.0
pkgbuild=1
arch=("auto")

shortdesc=("The Objective Caml compiler and programming environment.")

source=("https://caml.inria.fr/distrib/ocaml-${pkgver%.*}/${pkgname}-${pkgver}.tar.xz")

tags=("develop dev-lang")

build_deps=("ncurses")

build() {
  go_src_dir
  burn_patches
  CFLAGS+=' -ffat-lto-objects'
  CXXFLAGS+=' -ffat-lto-objects'
  ./configure \
    --prefix /usr \
    --mandir /usr/share/man \
    -enable-frame-pointers
  make --debug=v world.opt
  make DESTDIR=${pkgdir} install

  install -m755 -d ${pkgdir}/usr/share/licenses/${pkgname}
  install -m644 LICENSE ${pkgdir}/usr/share/licenses/${pkgname}/
}
