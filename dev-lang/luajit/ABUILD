pkgname=luajit
_commit=637721d00f0c9203542657a1acba6f4cc9b78aca
pkgver=2.1.0.beta3.r457.g${_commit::8}
pkgbuild=1
arch=("auto")

shortdesc=("Just-in-time compiler and drop-in replacement for Lua 5.1.")
longdesc=("Just-In-Time Compiler for the Lua programming language.")

source=("https://repo.or.cz/luajit-2.0.git/snapshot/${_commit}.tar.gz")

tags=("dev-lang develop")

build_deps=("gcc gcc-libs")

build() {
  go_src_dir
  burn_patches
  make -j${numjobs} amalg PREFIX=/usr LIBDIR=/usr/lib
  make PREFIX=/usr LIBDIR=/usr/lib DESTDIR=${pkgdir} install
  install -Dm644 COPYRIGHT ${pkgdir}/usr/share/licenses/${pkgname}/COPYRIGHT

  ln -sf luajit-2.1.0-beta3 ${pkgdir}/usr/bin/luajit
}
