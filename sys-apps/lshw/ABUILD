pkgname=lshw
pkgver=B.02.19.2
pkgbuild=1
arch=("auto")

shortdesc=("A small tool to provide detailed information on the hardware configuration of the machine.")

source=("https://ezix.org/software/files/lshw-${pkgver}.tar.gz")

tags=("sys-apps utils")

# hwdata gtk2-compat
build_deps=("gcc sqlite gcc-libs")

# adddep=("hwdata")

# NOTE: Это опциональные зависимости
removedep=("gtk3")

build(){
  go_src_dir
  sed -i 's|/usr/bin/gtk-lshw|/usr/sbin/gtk-lshw|' src/gui/integration/gtk-lshw.desktop
  sed -i '/^LDFLAGS=$/d' src/core/Makefile src/gui/Makefile
  burn_patches
  export VERSION=${pkgver}
  make SBINDIR=/usr/bin
  make SBINDIR=/usr/bin gui
  make DESTDIR=${pkgdir}/ SBINDIR=/usr/bin install
  make DESTDIR=${pkgdir}/ SBINDIR=/usr/bin install-gui
  install -Dm0644 src/gui/integration/gtk-lshw.desktop ${pkgdir}/usr/share/applications/gtk-lshw.desktop
  install -Dm0644 src/gui/integration/gtk-lshw.pam ${pkgdir}/usr/share/doc/${pkgname}/gtk-lshw.pam
  install -Dm0644 src/gui/integration/console.apps ${pkgdir}/usr/share/doc/${pkgname}/console.apps
  rm -f ${pkgdir}/usr/share/lshw/{pci,usb}.ids
}
