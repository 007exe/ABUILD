pkgname=coreutils
pkgver=9.0
pkgbuild=4
arch=("auto")

shortdesc=("The basic file, shell and text manipulation utilities of the GNU operating system.")
longdesc=("The Coreutils package contains utilities for showing and setting the basic system characteristics.")

tags=("base sys-apps")

source=("http://ftp.gnu.org/gnu/coreutils/coreutils-${pkgver}.tar.xz")

build_deps=("acl attr gmp libcap openssl")

build() {
  go_src_dir
  burn_patches
  autoreconf -fiv
  sed -i '/test.lock/s/^/#/' gnulib-tests/gnulib.mk
# Поскольку сборка выполняется в среде fakeroot, следует снять ряд ограничений.
  FORCE_UNSAFE_CONFIGURE=1 ./configure \
    --prefix=/usr \
    --libexecdir=/usr/lib \
    --enable-no-install-program=groups,hostname,kill,uptime \
    --with-openssl \
    --sysconfdir=/etc
# NOTE: groups, hostname предоставляются пакетом inetutils.
# kill предоставляется пакетом psmisc.
# uptime предоставляется пакетом procps.
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}
