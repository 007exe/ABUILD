pkgname=hwloc
pkgver=2.7.0
pkgbuild=1
arch="auto"

shortdesc=("Portable Hardware Locality is a portable abstraction of hierarchical architectures")
longdesc=("The Portable Hardware Locality (hwloc) software package provides a portable abstraction (across OS, versions, architectures, ...) of the hierarchical topology of modern architectures, including NUMA memory nodes, sockets, shared caches, cores and simultaneous multithreading. It also gathers various system attributes such as cache and memory information as well as the locality of I/O devices such as network interfaces, InfiniBand HCAs or GPUs.")

source=("https://www.open-mpi.org/software/hwloc/v${pkgver%.*}/downloads/${pkgname}-${pkgver}.tar.bz2")

tags="app-misc console"

build_deps="glibc libtool libpciaccess cairo libxml2 pciutils libx11"

build() {
  go_src_dir
  burn_patches
  ./configure \
    --prefix=/usr \
    --sbindir=/usr/bin \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --enable-plugins \
    --sysconfdir=/etc
  make -j${numjobs}
  make DESTDIR="${pkgdir}" install

  install -Dm 644 COPYING -t "${pkgdir}/usr/share/licenses/${pkgname}"
}
