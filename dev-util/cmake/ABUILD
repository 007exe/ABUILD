pkgname=cmake
pkgver=3.21.2
pkgbuild=2
arch=('auto')

shortdesc=("Cross-platform, open-source make system")
longdesc=("CMake is used to control the software compilation process using simple platform and compiler independent configuration files. CMake generates native makefiles and workspaces that can be used in the compiler environment of your choice. CMake is quite sophisticated: it is possible to support complex environments requiring system configuration, pre-processor generation, code generation, and template instantiation.")

source=("http://www.cmake.org/files/v${pkgver%.*}/${pkgname}-${pkgver}.tar.gz")

tags=("develop dev-util")

gendeps_blacklist="usr/bin/cmake-gui"
#qt6-base
build_deps="libarchive curl rhash python-sphinx jsoncpp"

build() {
  go_src_dir
  burn_patches
  export CXXFLAGS+=" ${CPPFLAGS}"
  ./bootstrap \
    --prefix=/usr \
    --mandir=/share/man \
    --docdir=/share/doc/cmake \
    --sphinx-man \
    --system-libs \
    --parallel=$(/usr/bin/getconf _NPROCESSORS_ONLN)
#--no-system-jsoncpp \
#--no-system-librhash \
#--qt-gui Parameter including GUI
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
  install -Dm644 Copyright.txt $pkgdir/usr/share/licenses/$pkgname/LICENSE
}
