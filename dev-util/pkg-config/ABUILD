pkgname=pkg-config
pkgver=0.29.2
pkgbuild=2
arch=("auto")

shortdesc=("pkg-config (system for managing library compile/link flags)")
longdesc=("pkg-config is a system for managing library compile/link flags that works with automake and autoconf. It replaces the ubiquitous *-config scripts you may have seen with a single tool. See the man page that comes with pkg-config for full documentation.")

tags=("develop dev-util")

source=("http://pkgconfig.freedesktop.org/releases/${pkgname}-${pkgver}.tar.gz")

build_deps="glib2 popt pcre"

build() {
  go_src_dir
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --with-installed-glib \
    --with-installed-popt
  make
  make DESTDIR=${pkgdir} install
}


after_build() {
  mkdir -p ${pkgdir}/etc/profile.d/
    for script in $(ls ${filedir}/scripts/*) ; do
        cat ${script} | sed -e "s#/lib/#/lib${LIBDIRSUFFIX}/#g" \
        > ${pkgdir}/etc/profile.d/$(basename ${script})
    done
  chown root:root ${pkgdir}/etc/profile.d/*
  chmod 755 ${pkgdir}/etc/profile.d/*

  mkdir -p ${pkgdir}/install
    zcat ${filedir}/doinst.sh.gz | sed -e "s#/lib/#/lib${LIBDIRSUFFIX}/#g" \
        > ${pkgdir}/install/doinst.sh
}
