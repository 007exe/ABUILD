# ABUILD generated by mkpkg_generator.sh

pkgname=meson
pkgver=0.55.3
pkgbuild=1
arch=("auto")

shortdesc=("High productivity build system")

tags=("dev-util develop")

source=("https://github.com/mesonbuild/meson/releases/download/${pkgver}/meson-${pkgver}.tar.gz")

build_deps="python-setuptools ninja pkg-config"

build() {
  go_src_dir
  python setup.py build

#   export LC_CTYPE=en_US.UTF-8 CPPFLAGS= CFLAGS= CXXFLAGS= LDFLAGS=
#  ./run_tests.py
}

after_build() {
  go_src_dir

  python setup.py install --root="${pkgdir}" --optimize=1 --skip-build

  install -d "${pkgdir}/usr/share/vim/vimfiles"
  cp -rt "${pkgdir}/usr/share/vim/vimfiles" data/syntax-highlighting/vim/*/

  install -Dt "${pkgdir}/usr/share/bash-completion/completions" -m644 data/shell-completions/bash/*
  install -Dt "${pkgdir}/usr/share/emacs/site-lisp" -m644 data/syntax-highlighting/emacs/*
  install -Dt "${pkgdir}/usr/share/zsh/site-functions" -m644 data/shell-completions/zsh/*
}
