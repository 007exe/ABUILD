#ABUILD created by: NK, nk-man at yandex.ru 
pkgbase=docutils
pkgname=python-docutils
pkgver=0.16
pkgbuild=1
arch=('auto')

shortdesc="Docutils: Documentation Utilities"

source=("http://downloads.sourceforge.net/$pkgbase/$pkgbase-$pkgver.tar.gz")

tags="dev-python develop"

build_deps="python"

adddep="python"

build() {
	go_src_dir
	python3 setup.py build --build-lib=build/python
  find build/python -type f -exec \
    sed -i '1s,^#! \?/usr/bin/\(env \|\)python$,#!/usr/bin/python3,' {} \;

python setup.py build --build-lib=build/python \
                  install --root="$pkgdir" --optimize=1
  # symlink without .py
  for f in "$pkgdir"/usr/bin/*.py; do
      ln -s "$(basename $f)" "$pkgdir/usr/bin/$(basename $f .py)"
  done
  # setup license
  install -D -m644 COPYING.txt "$pkgdir/usr/share/licenses/$pkgname/COPYING.txt"
  install -D -m644 licenses/python* "$pkgdir/usr/share/licenses/$pkgname/"	
}
