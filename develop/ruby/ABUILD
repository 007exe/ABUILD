pkgname=ruby
pkgver=3.0.1
pkgbuild=1
arch=("auto")

shortdesc="Object Oriented Script Language"
longdesc="Ruby is the interpreted scripting language for quick and easy object-oriented programming.  It has many features to process text files and to do system management tasks (as in Perl).  It is simple, straight-forward, and extensible."

tags=("develop dev-ruby")

source=("https://cache.ruby-lang.org/pub/ruby/${pkgver:0:3}/ruby-${pkgver}.tar.xz")

pkglist="rubydocs"

build_deps="gdbm openssl libffi"

build() {
  go_src_dir
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --sysconfdir=/etc \
    --enable-shared \
    --enable-pthread \
    --disable-rpath \
    --with-dbm-type=gdbm_compat
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}

rubydocs() {
pkgname=ruby-docs
shortdesc="Ruby documentation"
longdesc="Ruby documentation"
arch="noarch"
}

rubydocs_prep() {
  set -e
  mkdir -p ${pkgdir}/usr
  mv ${p_pkgdir}/usr/share/doc ${pkgdir}/usr/

  if [ -d ${p_pkgdir}/usr/share/doc ] ; then
          mkdir -p ${pkgdir}/usr/share
          mv ${p_pkgdir}/usr/share/doc ${pkgdir}/usr/share/
  fi
  set +e
}
