pkgname=cmocka
pkgver=1.1.5
pkgbuild=1
arch=('auto')

shortdesc=("Elegant unit testing framework for C with support for mock objects")
longdesc=("cmocka is a unit testing framework for C with support for mock objects. It only requires the standard C library, works on a range of computing platforms (including embedded) and with different compilers.")

source=("https://cmocka.org/files/1.1/cmocka-${pkgver}.tar.xz")

tags=("develop dev-util")

build_deps="glibc cmake"

build() {
  go_src_dir
  burn_patches
  mkdir build
  cd build
  cmake .. \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_LIBDIR=lib${LIBDIRSUFFIX} \
    -DCMAKE_BUILD_TYPE=Release \
    -DUNIT_TESTING=ON
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}
