pkgname=m4
pkgver=1.4.18
pkgbuild=2
arch=("auto")

shortdesc=("An implementation of the UNIX macro processor")
longdesc=("GNU M4 is an implementation of the traditional Unix macro processor. It is mostly SVR4 compatible although it has some extensions (for example, handling more than 9 positional parameters to macros). GNU M4 also has built-in functions for including files, running shell commands, doing arithmetic, etc.")

tags=("develop dev-util")

source=("ftp://ftp.gnu.org/gnu/m4/$pkgname-$pkgver.tar.xz")

build_deps="glibc"

adddep="bash"

build() {
  go_src_dir
#Fix glibc-2.28 <=
  sed -i 's/IO_ftrylockfile/IO_EOF_SEEN/' lib/*.c
  echo "#define _IO_IN_BACKUP 0x100" >> lib/stdio-impl.h

  ./configure --prefix=/usr \
    -libdir=/usr/lib${LIBDIRSUFFIX}
  make prefix="${pkgdir}"/usr install
}
