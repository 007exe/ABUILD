pkgname=nilfs-utils
pkgver=2.2.8
pkgbuild=2
arch=("auto")

shortdesc="Tools for nilfs filesystem"
longdesc="NILFS is a log-structured file system supporting versioning of the entire file system and continuous snapshotting which allows users to even restore files mistakenly overwritten or destroyed just a few seconds ago."

source=("http://nilfs.sourceforge.net/download/nilfs-utils-${pkgver}.tar.bz2")

tags="sys-fs base"

build_deps="util-linux-ng"

build() {
  go_src_dir
  burn_patches
  sed -i -e 's#root_sbindir=/sbin#root_sbindir=/usr/bin#' configure
  ./configure \
    --prefix=/usr \
    --sbindir=/usr/bin \
    --libdir=/usr/lib${LIBDIRSUFFIX} \
    --with-libmount
  make
  make DESTDIR="$pkgdir" sbindir=/usr/bin install LDCONFIG=/bin/true
}
