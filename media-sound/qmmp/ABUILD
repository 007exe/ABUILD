pkgname=qmmp
pkgver=2.1.5
pkgbuild=1
arch=("auto")

shortdesc=("Qt-based Multimedia Player.")

source=("http://qmmp.ylsoftware.com/files/qmmp/${pkgver%.*}/qmmp-${pkgver}.tar.bz2")

tags=("apps media-sound")

adddep=("alsa-lib curl desktop-file-utils hicolor-icon-theme libmad libvorbis libogg
libxkbcommon-x11 taglib xdg-utils qt6-base")

# projectm libsidplayfp
build_deps=("${adddep} cmake flac jack libmpcdec pipewire pulseaudio ffmpeg libcddb
libcdio-paranoia libmms libsamplerate libmodplug libsndfile wavpack mpg123 mesa
faad2 libgme opusfile wildmidi qt6-tools")

# NOTE: Это опциональные зависимости
removedep=("mpg123 flac jack libmpcdec pulseaudio pipewire libcdio-paranoia libcddb
libmms libmodplug libsndfile projectm faad2 libgme libsidplayfp opusfile wildmidi
ffmpeg libsamplerat wavpack")

build() {
  go_src_dir
  burn_patches
  cmake . \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_LIBDIR=lib \
    -DUSE_HAL:BOOL=FALSE
  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}
