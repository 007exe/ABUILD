pkgname=ncmpcpp
pkgver=0.9.2
pkgbuild=1
arch=("auto")

shortdesc=("Almost exact clone of ncmpc with some new features.")

source=("https://rybczak.net/ncmpcpp/stable/${pkgname}-${pkgver}.tar.bz2")

tags=("console media-sound")

adddep=("curl libmpdclient fftw boost-libs icu glibc gcc-libs ncurses readline taglib")

build_deps=("${adddep} boost")

build(){
  go_src_dir
  autoreconf -fiv
  sed -e 's/CXXFLAGS=/CXXFLAGS+=/' \
      -e 's/CPPFLAGS=/CPPFLAGS+=/' \
      -e 's/LDFLAGS=/LDFLAGS+=/' \
      -i extras/Makefile
  export CPPFLAGS+=' -DU_USING_ICU_NAMESPACE=1'
  CXXFLAGS+=' -Wno-error=deprecated-declarations'
  BOOST_LIB_SUFFIX='' ./configure \
    --prefix=/usr \
    --enable-clock \
    --enable-outputs \
    --enable-visualizer \
    --with-fftw \
    --with-taglib
  make -j${numjobs}
  make -C extras
  make DESTDIR=${pkgdir} install
  install -Dm 755 extras/artist_to_albumartist -t ${pkgdir}/usr/bin
}
