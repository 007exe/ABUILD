pkgname=wget
pkgver=1.21.1
pkgbuild=1
arch=("auto")

shortdesc="A utility for retrieving files using the HTTP or FTP protocols"
longdesc="GNU Wget is a file retrieval utility which can use either the HTTP or FTP protocols. Wget features include the ability to work in the background while you're logged out, recursive retrieval of directories, file name wildcard matching, remote file timestamp storage and comparison, use of Rest with FTP servers and Range with HTTP servers to retrieve files over slow or unstable connections, support for Proxy servers, and configurability."

tags=("network net-misc")

source=("http://ftp.gnu.org/gnu/wget/wget-${pkgver}.tar.gz")

build_deps="glibc openssl libidn pcre2 util-linux-ng"

adddep="ca-certificates"

config_files="etc/wgetrc"

build() {
  go_src_dir
  burn_patches
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib$LIBDIRSUFFIX \
    --sysconfdir=/etc \
    --disable-rpath \
    --with-ssl=openssl \
    --enable-nls

  make -j${numjobs}
  make DESTDIR=${pkgdir} install
}

after_build() {
  cat >> "$pkgdir/etc/wgetrc" <<EOF
# default root certs location
ca_certificate=/etc/ssl/certs/ca-certificates.crt
EOF
}
